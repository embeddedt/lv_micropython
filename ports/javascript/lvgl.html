<!doctype html>
<html>
  <head>
    <script src="build/micropython.js"></script>
  </head>
  <body>
    <div id='mp_js_stdout'></div>
<!-- Create the canvas that the C++ code will draw into -->
    <canvas id="canvas" width="480" height="320" oncontextmenu="event.preventDefault()"></canvas>

    <script>
      Module.canvas = (function() {
        console.log("Someone wants a canvas");
        var canvas = document.getElementById('canvas');
        return canvas;
	})(); 
	var lines = [
		"print('hello')",
		"import lvgl as lv",
		"lv.init()",
		"import SDL",
                "help(SDL)",
                "SDL.init()",
		/* Register SDL display driver. */
		"disp_drv = lv.disp_drv_t()",
		"lv.disp_drv_init(disp_drv)",
		"disp_drv.disp_flush = SDL.monitor_flush",
		"disp_drv.disp_fill = SDL.monitor_fill",
		"disp_drv.disp_map = SDL.monitor_map",
		"lv.disp_drv_register(disp_drv)",
		"print('hello2')",
		/*Regsiter SDL mouse driver*/
		"indev_drv = lv.indev_drv_t()",
		"lv.indev_drv_init(indev_drv)",
		"indev_drv.type = lv.INDEV_TYPE.POINTER;",
		"indev_drv.read = SDL.mouse_read;",
		"lv.indev_drv_register(indev_drv);",
		"print('hello3')",
		/* Create a screen with a button and a label */
		"scr = lv.obj()",
		"btn = lv.btn(scr)",
		"btn.align(lv.scr_act(), lv.ALIGN.CENTER, 0, 0)",
		"label = lv.label(btn)",
		"label.set_text('Button')",
		/* Load the screen */
		"lv.scr_load(scr)"
	];
      mp_js_init(64 * 1024);
      mp_js_stdout.addEventListener('print', function(e) {
        document.write(e.data);
      }, false);
	for(var i = 0;i < lines.length;i++){
	   mp_js_do_str(lines[i]);
	}


    </script>
  </body>
</html>

